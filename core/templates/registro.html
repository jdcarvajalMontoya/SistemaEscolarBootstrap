{% extends "base.html" %}
{% load static %}
{% block body_class %}no-aside registro-page{% endblock %}
{% load widget_tweaks %}

{% block title %}Registro de Usuario{% endblock %}

{% block extra_head %}
  <link rel="stylesheet" href="{% static 'css/registro.css' %}">
  <!-- Bootstrap Icons para los íconos de ojo -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
{% endblock %}

{% block content %}
<div class="registro-container">
  <div class="registro-wrapper">
    <div class="registro-column">
      <div class="registro-card">
        <div class="registro-card-body">

          <!-- Header -->
          <div class="registro-header">
            <h2 class="registro-title">Registro de Usuario</h2>
            <a href="{% url 'login' %}" class="registro-btn-secondary">Volver a iniciar sesión</a>
          </div>

          {% if messages %}
            {% for message in messages %}
              <div class="registro-alert registro-alert-{{ message.tags }}">
                {{ message }}
                <button type="button" class="registro-btn-close" onclick="this.parentElement.style.display='none'">&times;</button>
              </div>
            {% endfor %}
          {% endif %}

          <!-- Formulario -->
          <form method="post" novalidate>
            {% csrf_token %}

            <!-- Correo -->
            <div class="registro-field">
              <label for="id_correo" class="registro-label">Correo Electrónico</label>
              {{ form.correo|add_class:"registro-input" }}
              {% if form.correo.errors %}
                <span class="registro-error">{{ form.correo.errors.0 }}</span>
              {% endif %}
            </div>

            <!-- Rol -->
            <div class="registro-field">
              <label for="id_rol" class="registro-label">Rol</label>
              {{ form.rol|add_class:"registro-select" }}
              {% if form.rol.errors %}
                <span class="registro-error">{{ form.rol.errors.0 }}</span>
              {% endif %}
            </div>
            <div id="coordinador-alerta" class="registro-alert registro-alert-warning registro-hidden">
              ⚠️ Tu cuenta será revisada por un Superusuario antes de poder ingresar.
            </div>

            <!-- Tipo Documento -->
            <div class="registro-field">
              <label for="id_tipo_documento" class="registro-label">Tipo de Documento</label>
              {{ form.tipo_documento|add_class:"registro-select" }}
            </div>

            <!-- Número Documento -->
            <div class="registro-field">
              <label for="id_numero_documento" class="registro-label">Número de Documento</label>
              {{ form.numero_documento|add_class:"registro-input" }}
            </div>

            <!-- País -->
            <div class="registro-field">
              <label for="id_pais_identificacion" class="registro-label">País de Expedición</label>
              {{ form.pais_identificacion|add_class:"registro-select" }}
            </div>

            <!-- Departamento -->
            <div class="registro-field">
              <label for="id_departamento_identificacion" class="registro-label">Departamento de Expedición</label>
              {{ form.departamento_identificacion|add_class:"registro-select" }}
            </div>

            <!-- Municipio -->
            <div class="registro-field">
              <label for="id_municipio_identificacion" class="registro-label">Municipio de Expedición</label>
              {{ form.municipio_identificacion|add_class:"registro-select" }}
            </div>

            <!-- Contraseña -->
            <div class="registro-password-field">
              <label for="id_password" class="registro-label">Contraseña</label>
              <div class="registro-input-wrapper">
                {{ form.password|add_class:"registro-input registro-password-input"|attr:"id:id_password" }}
                <button type="button" class="registro-password-toggle"
                        onclick="togglePasswordIcon('id_password', this)">
                  <i class="bi bi-eye-slash"></i>
                </button>
              </div>

              <div class="registro-progress">
                <div id="password-strength" class="registro-progress-bar"></div>
              </div>

              <ul class="registro-requirements" id="password-requirements">
                <li id="len">✔️ Al menos 8 caracteres</li>
                <li id="mayus">✔️ Una letra mayúscula</li>
                <li id="minus">✔️ Una letra minúscula</li>
                <li id="num">✔️ Un número</li>
                <li id="sym">✔️ Un símbolo especial (# $ % ! _)</li>
              </ul>
            </div>

            <!-- Confirmar Contraseña -->
            <div class="registro-password-field">
              <label for="id_confirmar_password" class="registro-label">Confirmar Contraseña</label>
              <div class="registro-input-wrapper">
                {{ form.confirmar_password|add_class:"registro-input registro-password-input"|attr:"id:id_confirmar_password" }}
                <button type="button" class="registro-password-toggle"
                        onclick="togglePasswordIcon('id_confirmar_password', this)">
                  <i class="bi bi-eye-slash"></i>
                </button>
              </div>
            </div>

            <!-- Botón -->
            <div class="registro-submit-wrapper">
              <button type="submit" class="registro-btn-primary">Registrarse</button>
            </div>
          </form>

        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/registro.js' %}"></script>
{% endblock %}
